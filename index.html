<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VoxPop ‚Äî –ü—É–±–ª–∏—á–Ω–∞—è –¥–æ—Å–∫–∞ –º–Ω–µ–Ω–∏–π</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900 p-4">
    <div class="max-w-3xl mx-auto">
        <h1 class="text-3xl font-bold mb-6 text-center">üó£ VoxPop ‚Äî –ü—É–±–ª–∏—á–Ω–∞—è –¥–æ—Å–∫–∞ –º–Ω–µ–Ω–∏–π</h1>

        <!-- New Comment Form -->
        <form id="comment-form" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-6">
            <textarea id="comment-text" class="w-full p-2 border rounded mb-4" rows="3" placeholder="–í–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." required></textarea>
            <div class="flex items-center gap-4 mb-4">
                <label><input type="radio" name="category" value="positive" required> üòä –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–π</label>
                <label><input type="radio" name="category" value="negative"> üòû –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–π</label>
            </div>
            <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded">
                –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
            </button>
        </form>

        <!-- Comment Feed -->
        <div class="space-y-4">
            {% for comment in comments %}
            <div class="bg-white p-4 rounded shadow-md border-l-4 {% if comment.category == 'positive' %}border-green-500{% else %}border-red-500{% endif %}">
                <p class="text-sm text-gray-600">{{ comment.timestamp }}</p>
                <p class="text-lg">{{ comment.text }}</p>
                <span class="text-xs uppercase text-gray-500">{{ comment.category }}</span>
            </div>
            {% endfor %}
        </div>

        <!-- Pagination -->
        <div class="mt-6 flex justify-between">
            {% if page > 1 %}
                <a href="/?page={{ page - 1 }}" class="text-blue-500 hover:underline">‚Üê –ù–∞–∑–∞–¥</a>
            {% else %}
                <span></span>
            {% endif %}
            {% if page < total_pages %}
                <a href="/?page={{ page + 1 }}" class="text-blue-500 hover:underline">–í–ø–µ—Ä–µ–¥ ‚Üí</a>
            {% endif %}
        </div>
    </div>

    <script>
        document.getElementById('comment-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const text = document.getElementById('comment-text').value;
            const category = document.querySelector('input[name=category]:checked').value;

            const res = await fetch('/comment', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, category })
            });

            if (res.ok) {
                window.location.reload();
            } else {
                alert('–û—à–∏–±–∫–∞: –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω.');
            }
        });
    </script>
</body>
</html>

